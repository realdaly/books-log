(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43881,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],43881)},57740,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(45438),l=e.i(99786),r=e.i(43881),i=e.i(75254);let n=(0,i.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),c=(0,i.default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),d=(0,i.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),o=(0,i.default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);function h(){let[i,h]=(0,t.useState)({publisher_name:"شركة نشر"}),[p,m]=(0,t.useState)(!0);(0,t.useEffect)(()=>{!async function(){try{let e=await (0,s.getDb)(),a=await e.select("SELECT * FROM config ORDER BY id DESC LIMIT 1");a.length>0&&h({publisher_name:a[0].publisher_name||""})}catch(e){console.error(e)}finally{m(!1)}}()},[]),(0,t.useEffect)(()=>{if(!p){let e=document.querySelector("input");e&&e.focus()}},[p]);let u=async()=>{try{let e=await (0,s.getDb)(),a=await e.select("SELECT id FROM config ORDER BY id DESC LIMIT 1");a.length>0?await e.execute("UPDATE config SET publisher_name=$1 WHERE id=$2",[i.publisher_name,a[0].id]):await e.execute("INSERT INTO config (publisher_name) VALUES ($1)",[i.publisher_name]),alert("تم الحفظ بنجاح")}catch(e){alert("Error: "+e.message)}},b=async()=>{try{let{save:a}=await e.A(27431),{BaseDirectory:t,copyFile:s}=await e.A(56178),l=await a({defaultPath:`قاعدة بيانات الجرد ${new Date().toISOString().split("T")[0]}.db`,filters:[{name:"SQLite Database",extensions:["db"]}]});if(!l)return;await s("publishing.db",l,{fromPathBaseDir:t.AppData}),alert("تم حفظ نسخة احتياطية بنجاح")}catch(e){console.error(e),alert("حدث خطأ أثناء التصدير: "+e.message)}},x=async()=>{try{let{open:a,confirm:t}=await e.A(27431),{BaseDirectory:l,copyFile:r,remove:i,exists:n}=await e.A(56178),c=await a({filters:[{name:"SQLite Database",extensions:["db"]}]});if(!c)return;if(await t("سيتم استبدال قاعدة البيانات الحالية بالملف المختار. هل أنت متأكد؟ (سيتم إعادة تحميل التطبيق)",{title:"تأكيد استيراد قاعدة البيانات",kind:"warning"})){try{let e=await (0,s.getDb)();await e.execute("PRAGMA journal_mode=DELETE;"),"function"==typeof e.close&&await e.close()}catch(e){console.warn("Failed to close DB or switch journal mode:",e)}try{await n("publishing.db-wal",{baseDir:l.AppData})&&await i("publishing.db-wal",{baseDir:l.AppData}),await n("publishing.db-shm",{baseDir:l.AppData})&&await i("publishing.db-shm",{baseDir:l.AppData})}catch(e){console.warn("Cleanup WAL/SHM filesystem error:",e)}await r(c,"publishing.db",{toPathBaseDir:l.AppData}),window.location.href="/"}}catch(e){console.error(e),alert("حدث خطأ أثناء الاستيراد: "+e.message)}};return p?(0,a.jsx)(r.Loader2,{className:"animate-spin"}):(0,a.jsxs)("div",{className:"space-y-6 max-w-xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-primary text-center",children:"الإعدادات"}),(0,a.jsxs)(l.Card,{className:"p-8 space-y-6 shadow-xl border-0",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"block text-sm font-black text-primary/60 uppercase tracking-wider",children:"اسم المؤسسة"}),(0,a.jsx)(l.Input,{value:i.publisher_name,onChange:e=>h({...i,publisher_name:e.target.value}),className:"text-xl py-6",placeholder:"أدخل اسم المؤسسة هنا..."})]}),(0,a.jsxs)(l.Button,{onClick:u,size:"lg",className:"w-full flex justify-center items-center gap-3",children:[(0,a.jsx)(n,{size:24}),(0,a.jsx)("span",{className:"text-lg",children:"حفظ الإعدادات"})]})]}),(0,a.jsxs)(l.Card,{className:"p-8 space-y-6 shadow-xl border-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 border-b pb-4",children:[(0,a.jsx)(o,{className:"text-primary"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-primary",children:"إدارة قاعدة البيانات"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)(l.Button,{onClick:b,variant:"outline",className:"flex-1 gap-2 h-14 text-emerald-700 bg-emerald-50 hover:bg-emerald-100 border-emerald-200",children:[(0,a.jsx)(c,{size:20}),"تصدير قاعدة البيانات"]}),(0,a.jsxs)(l.Button,{onClick:x,variant:"outline",className:"flex-1 gap-2 h-14 text-amber-700 bg-amber-50 hover:bg-amber-100 border-amber-200",children:[(0,a.jsx)(d,{size:20}),"استيراد قاعدة بيانات"]})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center bg-gray-50 p-3 rounded-lg border border-dashed",children:"ملاحظة: عند استيراد قاعدة بيانات، سيتم استبدال جميع البيانات الحالية بالبيانات الموجودة في الملف المستورد."})]})]})}e.s(["default",()=>h],57740)},27431,e=>{e.v(a=>Promise.all(["static/chunks/2c9ea87d4ada6870.js"].map(a=>e.l(a))).then(()=>a(68078)))},56178,e=>{e.v(a=>Promise.all(["static/chunks/c3d4926979268802.js"].map(a=>e.l(a))).then(()=>a(76906)))}]);